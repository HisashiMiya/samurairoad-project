<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>AI Cockpit & Search</title>
  <meta name="description" content="AIã¨æ¤œç´¢ã‚’çµ±åˆã—ãŸå¸ä»¤å®¤ãƒ„ãƒ¼ãƒ«" />
  <link rel="stylesheet" href="search_engine.css">
  <style>
    /* è¿½åŠ ã‚¹ã‚¿ã‚¤ãƒ«ï¼šAIãƒ¢ãƒ¼ãƒ‰ç”¨ï¼ˆå…ƒã®ã¾ã¾ï¼‹é“å…·æ£šï¼‰ */
    .mode-select-wrap {
      margin-bottom: 1rem;
      background: #f0f4f8;
      padding: 10px;
      border-radius: 8px;
      border: 1px solid #dce3e8;
    }
    .mode-label {
      font-weight: bold;
      font-size: 0.9rem;
      color: #333;
      display: block;
      margin-bottom: 0.5rem;
    }
    .ai-badge {
      display: inline-block;
      padding: 2px 6px;
      border-radius: 4px;
      font-size: 0.75rem;
      margin-left: 5px;
      background: #e2e8f0;
      color: #475569;
    }
    .toast {
      position: fixed;
      bottom: 20px;
      left: 50%;
      transform: translateX(-50%);
      background: rgba(0,0,0,0.85);
      color: #fff;
      padding: 10px 16px;
      border-radius: 6px;
      font-size: 0.9rem;
      opacity: 0;
      transition: opacity 0.25s;
      pointer-events: none;
      z-index: 999;
      max-width: calc(100% - 24px);
      text-align: center;
    }
    .toast.show { opacity: 1; }

    /* é“å…·æ£š */
    .shelf-grid{
      display:grid;
      grid-template-columns: 1fr;
      gap: 10px;
      margin-top: 10px;
    }
    @media (min-width: 720px){
      .shelf-grid{ grid-template-columns: 1fr 1fr; }
    }
    .shelf-item{
      border: 1px solid #e5e7eb;
      border-radius: 12px;
      padding: 12px;
      background: #fff;
    }
    .shelf-title{
      font-weight: 700;
      margin-bottom: 6px;
    }
    .shelf-desc{
      margin: 0 0 10px;
      color: #555;
      font-size: 0.92rem;
      line-height: 1.5;
    }
    .shelf-actions{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      align-items:center;
    }
    .btn-shelf{
      min-height: 44px;
      padding: 10px 12px;
      border-radius: 999px;
      border: 1px solid #d0d7de;
      background: #fff;
      cursor: pointer;
      font-weight: 600;
    }
    .btn-shelf:hover{ background:#f6f8fa; }
    .note{
      font-size: 0.85rem;
      color: #666;
      margin-top: 10px;
      line-height: 1.6;
    }
    .note small{ color:#777; }
    .row2{
      display:flex;
      gap:12px;
      flex-wrap:wrap;
      align-items:center;
      margin-top: 10px;
    }
  </style>
</head>

<body>
  <header class="header">
    <div class="container header-inner">
      <div class="brand">
        <div class="brand-title">AI Cockpit</div>
        <div class="brand-sub">SamuraiRoad & Data Analysis Hub</div>
      </div>
      <a class="btn btn-ghost" href="index.html">ãƒˆãƒƒãƒ—ã¸</a>
    </div>
  </header>

  <main class="container">
    <section class="card">
      <h1 class="h1">å¸ä»¤å®¤ (Command Center)</h1>
      <p class="lead">ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã‚’å…¥åŠ›ã—ã€AIã¾ãŸã¯æ¤œç´¢ã‚¨ãƒ³ã‚¸ãƒ³ã‚’é¸æŠã—ã¦ãã ã•ã„ã€‚</p>

      <div class="controls">
        <div class="mode-select-wrap">
          <label class="mode-label" for="promptMode">
            ğŸ› ï¸ å‹•ä½œãƒ¢ãƒ¼ãƒ‰ï¼ˆè‡ªå‹•ã§æŒ‡ç¤ºã‚’ä»˜ä¸ã—ã¾ã™ï¼‰
          </label>
          <select id="promptMode" class="select">
            <option value="normal">é€šå¸¸æ¤œç´¢ï¼ˆã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã®ã¿ï¼‰</option>
            <option value="history">æ­´å²èª¿æŸ» (SamuraiRoadç”¨)</option>
            <option value="code">ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚° (Webåˆ¶ä½œ)</option>
            <option value="summary">è¦ç´„ãƒ»æ•´ç† (é•·æ–‡ãªã©)</option>
            <option value="analysis">ãƒ‡ãƒ¼ã‚¿åˆ†æ (çµ±è¨ˆ/ç«¶é¦¬/ç«¶è¼ª/ã‚ªãƒ¼ãƒˆ/ãƒœãƒ¼ãƒˆ)</option>
          </select>
          <div class="row2">
            <label class="check">
              <input id="copyOnAI" type="checkbox" checked>
              <span>AIãƒœã‚¿ãƒ³æŠ¼ä¸‹ã§æŒ‡ç¤ºã‚’è‡ªå‹•ã‚³ãƒ”ãƒ¼</span>
            </label>
            <label class="check">
              <input id="preferRawForSearch" type="checkbox" checked>
              <span>æ¤œç´¢ã‚¨ãƒ³ã‚¸ãƒ³ã«ã¯çŸ­ã„ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã®ã¿é€ã‚‹</span>
            </label>
          </div>
        </div>

        <label class="label" for="q">å…¥åŠ›ãƒ»æŒ‡ç¤ºå†…å®¹</label>
        <div class="searchbar">
          <input
            id="q"
            class="input"
            type="search"
            placeholder="ä¾‹ï¼šé ˆåŸå®¿ æ°´èˆ¹ æ­´å² / æ˜æ—¥ã®å·å£ã‚ªãƒ¼ãƒˆ 12R"
            autocomplete="off"
            enterkeyhint="search"
          />
          <button type="button" class="btn btn-primary" id="btnSearch">å®Ÿè¡Œ</button>
        </div>

        <div class="row">
          <label class="check">
            <input id="newtab" type="checkbox" checked>
            <span>æ–°ã—ã„ã‚¿ãƒ–ã§é–‹ã</span>
          </label>
          <label class="check">
            <input id="remember" type="checkbox" checked>
            <span>è¨­å®šã‚’è¨˜æ†¶</span>
          </label>
        </div>

        <div class="hint">â€» Enterã‚­ãƒ¼ã¯ã€ŒGoogleã€ã§å®Ÿè¡Œï¼ˆå¿…è¦ãªã‚‰å¾Œã§â€œæœ€å¾Œã«ä½¿ã£ãŸå…ˆâ€ã«ã‚‚ã§ãã¾ã™ï¼‰</div>
      </div>
    </section>

    <section class="card">
      <h2 class="h2">AI ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ <span class="lead small">â€»è‡ªå‹•ã‚³ãƒ”ãƒ¼æ©Ÿèƒ½ä»˜ã</span></h2>
      <p class="lead small">ãƒœã‚¿ãƒ³ã‚’æŠ¼ã™ã¨ã€ç¾åœ¨ã®ã€Œãƒ¢ãƒ¼ãƒ‰ã€ã«åˆã‚ã›ãŸæŒ‡ç¤ºæ–‡ã‚’ã‚³ãƒ”ãƒ¼ã—ã¦ã‚µã‚¤ãƒˆã‚’é–‹ãã¾ã™ï¼ˆå¯¾å¿œãƒ–ãƒ©ã‚¦ã‚¶ã®ã¿ï¼‰ã€‚ã‚ã¨ã¯è²¼ã‚Šä»˜ã‘ã‚‹ã ã‘ã€‚</p>

      <div class="engine-buttons" id="aiButtons">
        <button class="engine-btn" data-engine="chatgpt">ChatGPT</button>
        <button class="engine-btn" data-engine="gemini">Gemini</button>
        <button class="engine-btn" data-engine="perplexity">Perplexity</button>
        <button class="engine-btn" data-engine="copilot">Copilot</button>
        <button class="engine-btn" data-engine="claude">Claude</button>
      </div>
    </section>

    <section class="card">
      <h2 class="h2">Webæ¤œç´¢ãƒ»ãƒ„ãƒ¼ãƒ«</h2>
      <div class="engine-buttons" id="practicalButtons">
        <button class="engine-btn" data-engine="google">Google</button>
        <button class="engine-btn" data-engine="gmap">Googleãƒãƒƒãƒ—</button>
        <button class="engine-btn" data-engine="youtube">YouTube</button>
        <button class="engine-btn" data-engine="wikipedia">Wikipedia</button>
        <button class="engine-btn" data-engine="gimage">Googleç”»åƒ</button>
        <button class="engine-btn" data-engine="amazon">Amazon</button>
      </div>

      <div class="divider"></div>

      <details class="details">
        <summary class="summary">ãã®ä»–ã®æ¤œç´¢ã‚¨ãƒ³ã‚¸ãƒ³</summary>
        <div class="engine-buttons nostalgic">
          <button class="engine-btn" data-engine="bing">Bing</button>
          <button class="engine-btn" data-engine="duckduckgo">DuckDuckGo</button>
          <button class="engine-btn" data-engine="yahoo">Yahoo</button>
        </div>
      </details>
    </section>

    <!-- â‘¢ é“å…·æ£šï¼ˆAmazonå°ç·šï¼‰ -->
    <section class="card">
      <h2 class="h2">é“å…·æ£šï¼ˆè¡—é“æ­©ããƒ»åˆ¶ä½œã®è£…å‚™ï¼‰ <span class="ai-badge">Amazon</span></h2>
      <p class="lead small">æŠ¼ã—å£²ã‚Šã§ã¯ãªãã€Œæ¬¡ã®ä¸€æ­©ã«å¿…è¦ãªé“å…·ã€ã‚’ç½®ãæ£šã§ã™ã€‚æ¤œç´¢ã‚¯ã‚¨ãƒªã§é–‹ãã®ã§ã€å“åˆ‡ã‚Œã«ã‚‚å¼·ã„ã§ã™ã€‚</p>

      <div class="shelf-grid" id="gearShelf">
        <!-- JSã§ç”Ÿæˆ -->
      </div>

      <p class="note">
        <small>â€»ã‚¢ãƒ•ã‚£ãƒªã‚¨ã‚¤ãƒˆåˆ©ç”¨æ™‚ã¯ã€ãƒšãƒ¼ã‚¸ã©ã“ã‹ã«ã€Œå½“ã‚µã‚¤ãƒˆã¯ã‚¢ãƒ•ã‚£ãƒªã‚¨ã‚¤ãƒˆãƒªãƒ³ã‚¯ã‚’å«ã¿ã¾ã™ã€ç­‰ã®è¡¨è¨˜ã‚’ç½®ãã®ãŒå®‰å…¨ã§ã™ã€‚</small>
      </p>
    </section>
  </main>

  <div id="toast" class="toast">æŒ‡ç¤ºã‚’ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸã€‚è²¼ã‚Šä»˜ã‘ã¦ãã ã•ã„</div>

  <script>
    const STORAGE_KEY = "ai_cockpit_v11";
    const $ = (id) => document.getElementById(id);

    // Amazonã‚¢ã‚½ã‚·ã‚¨ã‚¤ãƒˆIDï¼ˆæŒã£ã¦ã„ã‚Œã°å…¥ã‚Œã‚‹ã€‚ä¾‹ï¼šyourtag-22ï¼‰
    const AMAZON_TAG = ""; // â†å¿…è¦ãªã‚‰è¨­å®š

    const PROMPTS = {
      normal: (q) => q,
      history: (q) => `ã‚ãªãŸã¯æ­´å²ã®å°‚é–€å®¶ã§ã™ã€‚ä»¥ä¸‹ã®ãƒ†ãƒ¼ãƒã«ã¤ã„ã¦ã€æ±Ÿæˆ¸æ™‚ä»£ã®å²å®Ÿã‚„æ–‡çŒ®ã«åŸºã¥ãã€æ­£ç¢ºã‹ã¤è©³ç´°ã«è§£èª¬ã—ã¦ãã ã•ã„ã€‚è¦³å…‰å®¢ãŒèˆˆå‘³ã‚’æŒã¡ãã†ãªé€¸è©±ãŒã‚ã‚Œã°ãã‚Œã‚‚å«ã‚ã¦ãã ã•ã„ã€‚\n\nãƒ†ãƒ¼ãƒ: ${q}`,
      analysis: (q) => `ã‚ãªãŸã¯ãƒ‡ãƒ¼ã‚¿ã‚¢ãƒŠãƒªã‚¹ãƒˆã§ã™ã€‚ä»¥ä¸‹ã®å¯¾è±¡ã«ã¤ã„ã¦ã€éå»ã®ãƒ‡ãƒ¼ã‚¿ã‚„å‚¾å‘ã‚’åˆ†æã—ã€è«–ç†çš„ãªäºˆæ¸¬ã‚„è€ƒå¯Ÿã‚’è¡Œã£ã¦ãã ã•ã„ã€‚å‹ç‡ã‚„æœŸå¾…å€¤ãªã©ã®è¦³ç‚¹ã‚‚å«ã‚ã¦ãã ã•ã„ã€‚\n\nå¯¾è±¡: ${q}`,
      code: (q) => `ã‚ãªãŸã¯å„ªç§€ãªWebã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ã§ã™ã€‚ä»¥ä¸‹ã®è¦ä»¶ã‚’å®Ÿç¾ã™ã‚‹ãŸã‚ã®ã€ãƒ¢ãƒ€ãƒ³ã§ã‚¯ãƒªãƒ¼ãƒ³ãªã‚³ãƒ¼ãƒ‰ï¼ˆHTML/CSS/JSç­‰ï¼‰ã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚è§£èª¬ã¯ç°¡æ½”ã«ãŠé¡˜ã„ã—ã¾ã™ã€‚\n\nè¦ä»¶: ${q}`,
      summary: (q) => `ä»¥ä¸‹ã®å†…å®¹ã‚’ã€è¦ç‚¹ã‚’æŠ¼ã•ãˆã¦åˆ†ã‹ã‚Šã‚„ã™ãè¦ç´„ã—ã¦ãã ã•ã„ã€‚ç®‡æ¡æ›¸ãã‚’ä½¿ã£ã¦æ§‹é€ åŒ–ã—ã¦ãã ã•ã„ã€‚\n\nå†…å®¹: ${q}`
    };

    // isAI: trueãªã‚‰ã€Œã‚³ãƒ”ãƒ¼ï¼†GOã€å¯„ã‚Š
    const ENGINE = {
      // AI
      chatgpt:    { url: "https://chatgpt.com/", isAI: true },
      gemini:     { url: "https://gemini.google.com/app", isAI: true },
      perplexity: { url: (q) => `https://www.perplexity.ai/search?q=${encodeURIComponent(q)}`, isAI: false },
      copilot:    { url: "https://copilot.microsoft.com/", isAI: true },
      claude:     { url: "https://claude.ai/new", isAI: true },

      // Search
      google:     { url: (q) => `https://www.google.com/search?q=${encodeURIComponent(q)}`, isAI: false },
      bing:       { url: (q) => `https://www.bing.com/search?q=${encodeURIComponent(q)}`, isAI: false },
      duckduckgo: { url: (q) => `https://duckduckgo.com/?q=${encodeURIComponent(q)}`, isAI: false },
      yahoo:      { url: (q) => `https://search.yahoo.co.jp/search?p=${encodeURIComponent(q)}`, isAI: false },
      youtube:    { url: (q) => `https://www.youtube.com/results?search_query=${encodeURIComponent(q)}`, isAI: false },
      amazon:     { url: (q) => buildAmazonSearchUrl(q), isAI: false },
      gmap:       { url: (q) => `https://www.google.com/maps/search/${encodeURIComponent(q)}`, isAI: false },
      gimage:     { url: (q) => `https://www.google.com/search?tbm=isch&q=${encodeURIComponent(q)}`, isAI: false },
      wikipedia:  { url: (q) => `https://ja.wikipedia.org/wiki/${encodeURIComponent(q.replace(/\s+/g, "_"))}`, isAI: false }
    };

    function showToast(msg) {
      const t = $("toast");
      t.textContent = msg;
      t.classList.add("show");
      setTimeout(() => t.classList.remove("show"), 2200);
    }

    function saveSettings() {
      if (!$("remember").checked) return;
      const s = {
        q: $("q").value,
        mode: $("promptMode").value,
        newtab: $("newtab").checked,
        remember: $("remember").checked,
        copyOnAI: $("copyOnAI").checked,
        preferRawForSearch: $("preferRawForSearch").checked
      };
      localStorage.setItem(STORAGE_KEY, JSON.stringify(s));
    }

    function loadSettings() {
      try {
        const s = JSON.parse(localStorage.getItem(STORAGE_KEY) || "{}");
        if (typeof s.q === "string") $("q").value = s.q;
        if (typeof s.mode === "string") $("promptMode").value = s.mode;
        if (typeof s.newtab === "boolean") $("newtab").checked = s.newtab;
        if (typeof s.remember === "boolean") $("remember").checked = s.remember;
        if (typeof s.copyOnAI === "boolean") $("copyOnAI").checked = s.copyOnAI;
        if (typeof s.preferRawForSearch === "boolean") $("preferRawForSearch").checked = s.preferRawForSearch;
      } catch {}
    }

    function openUrl(url) {
      if ($("newtab").checked) window.open(url, "_blank", "noopener,noreferrer");
      else location.href = url;
    }

    function buildAmazonSearchUrl(q) {
      const base = `https://www.amazon.co.jp/s?k=${encodeURIComponent(q)}`;
      if (!AMAZON_TAG) return base;
      // tagãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¯å•†å“ãƒšãƒ¼ã‚¸ã§åŠ¹ãã‚„ã™ã„ãŒã€æ¤œç´¢URLã«ã‚‚ä»˜ã‘ã¦ãŠãã¨å¾Œç¶šã§å¼•ãç¶™ãŒã‚Œã‚‹ã“ã¨ãŒã‚ã‚‹
      return base + `&tag=${encodeURIComponent(AMAZON_TAG)}`;
    }

    async function maybeCopy(text, label) {
      if (!$("copyOnAI").checked) return;
      if (!text) return;
      try {
        await navigator.clipboard.writeText(text);
        showToast(label || "æŒ‡ç¤ºã‚’ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸ");
      } catch (e) {
        console.warn("Copy failed", e);
        // å¤±æ•—ã—ã¦ã‚‚è‡´å‘½ã§ã¯ãªã„ã®ã§ã€é€šçŸ¥ã ã‘
        showToast("ã‚³ãƒ”ãƒ¼å¤±æ•—ï¼ˆãƒ–ãƒ©ã‚¦ã‚¶åˆ¶é™ã®å¯èƒ½æ€§ï¼‰");
      }
    }

    function buildFinalQuery(rawQ) {
      const mode = $("promptMode").value;
      const generator = PROMPTS[mode] || PROMPTS.normal;
      return { mode, final: generator(rawQ) };
    }

    async function run(engineKey) {
      const rawQ = $("q").value.trim();
      const conf = ENGINE[engineKey];
      if (!conf) return;

      // ä½•ã‚‚å…¥åŠ›ãŒãªã„å ´åˆã€æ¤œç´¢ã¯æ­¢ã‚ã€AIã¯é–‹ãã ã‘è¨±å¯
      if (!rawQ && !conf.isAI && engineKey !== "perplexity") {
        $("q").focus();
        return;
      }

      saveSettings();

      const { mode, final } = buildFinalQuery(rawQ);

      // AIç³»ï¼šã‚³ãƒ”ãƒ¼ã—ã¦é–‹ãï¼ˆPerplexityã¯URLã«ä¹—ã›ã‚‹æ–¹ãŒå¼·ã„ã®ã§ä¾‹å¤–ï¼‰
      if (conf.isAI) {
        await maybeCopy(final, `ã€${mode}ãƒ¢ãƒ¼ãƒ‰ã€‘æŒ‡ç¤ºã‚’ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸ`);
        const targetUrl = typeof conf.url === "function" ? conf.url(final) : conf.url;
        openUrl(targetUrl);
        return;
      }

      // æ¤œç´¢ç³»ï¼šçŸ­ã„ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã‚’å„ªå…ˆï¼ˆãƒã‚§ãƒƒã‚¯ã§åˆ‡æ›¿ï¼‰
      const qForSearch = $("preferRawForSearch").checked ? rawQ : final;
      const targetUrl = typeof conf.url === "function" ? conf.url(qForSearch) : conf.url;
      openUrl(targetUrl);
    }

    // é“å…·æ£šï¼ˆæ¤œç´¢ã‚¯ã‚¨ãƒªã§é–‹ãï¼šå“åˆ‡ã‚Œã«å¼·ã„ï¼†æ›´æ–°ä¸è¦ï¼‰
    const SHELF = [
      {
        title: "è¡—é“æ­©ãï¼šãƒ¢ãƒã‚¤ãƒ«ãƒãƒƒãƒ†ãƒªãƒ¼",
        desc: "é•·è·é›¢æ­©è¡Œã®ç”Ÿå‘½ç·šã€‚è–„å‹ãƒ»è»½é‡ãƒ»æ€¥é€Ÿå……é›»ãŒä¾¿åˆ©ã€‚",
        q: "ãƒ¢ãƒã‚¤ãƒ«ãƒãƒƒãƒ†ãƒªãƒ¼ 10000mAh è»½é‡ æ€¥é€Ÿå……é›»"
      },
      {
        title: "è¡—é“æ­©ãï¼šæ­©ãã‚„ã™ã„é´",
        desc: "çŸ³ç•³ã‚„èˆ—è£…è·¯ãŒæ··ã–ã‚‹ã®ã§ã€ã‚¯ãƒƒã‚·ãƒ§ãƒ³æ€§ã¨æ»‘ã‚Šã«ãã•é‡è¦–ã€‚",
        q: "ã‚¦ã‚©ãƒ¼ã‚­ãƒ³ã‚°ã‚·ãƒ¥ãƒ¼ã‚º ãƒ¡ãƒ³ã‚º ãƒ¬ãƒ‡ã‚£ãƒ¼ã‚¹ ã‚¯ãƒƒã‚·ãƒ§ãƒ³ æ»‘ã‚Šã«ãã„"
      },
      {
        title: "è¡—é“æ­©ãï¼šé›¨å¯¾ç­–",
        desc: "çªç„¶ã®é›¨ã«ã€‚è–„æ‰‹ãƒ¬ã‚¤ãƒ³ã‚¦ã‚§ã‚¢ï¼‹é˜²æ°´ã‚¹ã‚¿ãƒƒãƒ•ãƒãƒƒã‚°ãŒå¿«é©ã€‚",
        q: "ãƒ¬ã‚¤ãƒ³ã‚¦ã‚§ã‚¢ ä¸Šä¸‹ ã‚»ãƒƒãƒˆ è»½é‡ é˜²æ°´"
      },
      {
        title: "è¡—é“æ­©ãï¼šã‚¬ã‚¤ãƒ‰ãƒ–ãƒƒã‚¯",
        desc: "å®¿å ´ã®èƒŒæ™¯ãŒåˆ†ã‹ã‚‹ã¨æ­©ããŒæ¥½ã—ããªã‚‹ã€‚åœ°å›³ä»˜ããŒãŠã™ã™ã‚ã€‚",
        q: "ä¸­å±±é“ ã‚¬ã‚¤ãƒ‰ãƒ–ãƒƒã‚¯ å®¿å ´ æ­´å²"
      },
      {
        title: "åˆ¶ä½œï¼šä½œæ¥­åŠ¹ç‡ã‚¢ãƒƒãƒ—ï¼ˆã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ï¼‰",
        desc: "æ–‡ç« ãƒ»ã‚³ãƒ¼ãƒ‰ãŒå¤šã„ãªã‚‰ã€é™éŸ³ãƒ»æ‰“éµæ„Ÿã®è‰¯ã„ã‚‚ã®ãŒåŠ¹ãã€‚",
        q: "ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ é™éŸ³ ãƒ†ãƒ³ã‚­ãƒ¼ãƒ¬ã‚¹"
      },
      {
        title: "åˆ¶ä½œï¼šãƒã‚¤ã‚¯ï¼ˆå‹•ç”»/éŸ³å£°ï¼‰",
        desc: "ãƒ¬ãƒ“ãƒ¥ãƒ¼å‹•ç”»ã‚„è§£èª¬ã®éŸ³è³ªãŒä¸ŠãŒã‚‹ã¨è¦–è´ç¶­æŒç‡ãŒä¸ŠãŒã‚Šã‚„ã™ã„ã€‚",
        q: "USB ãƒã‚¤ã‚¯ ãƒã‚¤ã‚ºæŠ‘åˆ¶"
      }
    ];

    function renderShelf() {
      const wrap = $("gearShelf");
      wrap.innerHTML = "";
      SHELF.forEach((item) => {
        const el = document.createElement("div");
        el.className = "shelf-item";
        el.innerHTML = `
          <div class="shelf-title">${item.title}</div>
          <p class="shelf-desc">${item.desc}</p>
          <div class="shelf-actions">
            <button class="btn-shelf" data-shelf-q="${encodeURIComponent(item.q)}">Amazonã§æ¢ã™</button>
            <button class="btn-shelf" data-shelf-copy="${encodeURIComponent(item.q)}">æ¤œç´¢èªã‚’ã‚³ãƒ”ãƒ¼</button>
          </div>
        `;
        wrap.appendChild(el);
      });
    }

    // ã‚¯ãƒªãƒƒã‚¯ï¼ˆå¤šé‡ç™»éŒ²ã—ãªã„å½¢ã«ä¿®æ­£ï¼‰
    document.addEventListener("click", async (e) => {
      const btn = e.target.closest(".engine-btn");
      if (btn) {
        run(btn.dataset.engine);
        return;
      }
      const shelfBtn = e.target.closest(".btn-shelf");
      if (shelfBtn) {
        const q1 = shelfBtn.getAttribute("data-shelf-q");
        const q2 = shelfBtn.getAttribute("data-shelf-copy");
        if (q1) {
          openUrl(buildAmazonSearchUrl(decodeURIComponent(q1)));
        } else if (q2) {
          await maybeCopy(decodeURIComponent(q2), "æ¤œç´¢èªã‚’ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸ");
        }
        return;
      }
    });

    $("btnSearch").addEventListener("click", () => run("google"));

    $("promptMode").addEventListener("change", saveSettings);
    $("newtab").addEventListener("change", saveSettings);
    $("remember").addEventListener("change", saveSettings);
    $("copyOnAI").addEventListener("change", saveSettings);
    $("preferRawForSearch").addEventListener("change", saveSettings);

    $("q").addEventListener("keydown", (e) => {
      if (e.key === "Enter") {
        e.preventDefault();
        run("google");
      }
    });

    loadSettings();
    renderShelf();
  </script>
</body>
</html>
